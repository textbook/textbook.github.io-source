<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>Setting up static files in Django</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <link rel="stylesheet" href="../../../theme/css/main.557acf99.css">
  <style media="print">.is-hidden-print{display:none !important}</style>
      <link rel="stylesheet" href="../../../custom.css">
<meta property="og:title" content="textbook - Setting up static files in Django">
  <meta property="og:description" content="Avoiding duplication of static files by using Mercurial hooks.">
<meta property="og:url" content="../../../2015/Aug/15/django-static-shock.html">
    <meta property="og:image" content="../../../images/avatar.png">
    <meta name="twitter:image:alt" content="textbook | These are my opinions - if you don't like them, I have others">
<meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@jonrsharpe">
  <meta name="twitter:site" content="@jonrsharpe">
<meta property="og:site_name" content="textbook">
<meta property="og:type" content="article">
  <meta property="article:published_time" content="2015-08-15T18:47:00+01:00">
    <meta property="article:tag" content="code">
    <meta property="article:tag" content="python">
    <meta property="article:tag" content="django">
  <meta property="article:section" content="development">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="navbar">
        <div class="navbar-brand">
          <a class="navbar-item title is-3"
             href="../../../">textbook</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="navbar has-shadow is-hidden-print">
  <div class="container">
    <div class="navbar-center"></div>
    <span id="navToggle" class="navbar-burger">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-end">
              <a class="navbar-item is-tab "
                 href="../../../category/work.html">work</a>
              <a class="navbar-item is-tab "
                 href="../../../category/meta.html">meta</a>
              <a class="navbar-item is-tab is-active"
                 href="../../../category/development.html">development</a>
        </div>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
<section id="content" class="body">
  <article>
    <h1 class="title">
      <a href="../../../2015/Aug/15/django-static-shock.html" rel="bookmark"
         title="Permalink to Setting up static files in Django">Setting up static files in Django</a></h1>
<footer class="post-info">
  <abbr class="published" title="2015-08-15T18:47:00+01:00">
    Published <span class="is-info">Sat 15 August 2015</span>
    in <a href="../../../category/development.html">development</a>
  </abbr>

    <p class="author">
      <em>by           Jonathan Sharpe
</em>
      <span class="tag is-small is-rounded">
        <a href="../../../tag/code.html">code</a>
      </span>
      <span class="tag is-small is-rounded">
        <a href="../../../tag/python.html">python</a>
      </span>
      <span class="tag is-small is-rounded">
        <a href="../../../tag/django.html">django</a>
      </span>
    </p>
  
</footer>    <div class="section"><p>I've recently been working on a project to port a web application that I wrote 
at work in .NET to Python, using the Django framework. I wanted to see what the
advantages of using a language I'm more familiar with and adopting an agile, 
test-driven development methodology would be. I'm hosting it on <a href="https://www.pythonanywhere.com/">Python 
Anywhere</a>, which offers a great (and free, if your needs are 
relatively small) hosting service for Python web apps.</p>
<p>One thing to be aware of with Django is its handling of static files; there's 
a <a href="https://docs.djangoproject.com/en/1.8/howto/static-files/">whole manual page</a> on how to go about dealing with CSS and other
assets in testing and deployment, but the short version is that the deployed
version really needs to have all of the static files collected from their apps
(<code>/app/static/app/...</code>) to a central directory (<code>/static/app/...</code>). This is
easily achieved using <code>./manage.py collectstatic</code>, but means two copies of those
files in the working copy.</p>
<p>I already had <a href="https://bitbucket.org/jonrsharpe/dj_cv/issues/3/reduce-duplication-of-static-files">an open issue</a> on another Django-based project to avoid 
this kind of duplication; I used a commit hook there to run <code>collectstatic</code> on 
the development side, then push everything, which means that there are two copies 
of the site's static files in the repository. Instead, I decided for this new 
project to move the automated static collection to the <code>hg update</code> command (it's 
hosted on a private BitBucket repo using Mercurial, rather than Git, as I wanted 
to try out the other option). This means that it runs on the server side, and 
required two changes:</p>
<ol>
<li>
<p>Adding <code>^static/</code> (the static file directory in the root folder, which I'd 
 set up as <code>STATIC_ROOT</code> for the project) to the <code>.hgignore</code>, so that its 
 contents weren't being tracked by Mercurial; and</p>
</li>
<li>
<p>Adding an <code>update</code> hook to <code>.hg/hgrc</code> to perform the static file collection
 when I update the repository.</p>
</li>
</ol>
<p>The latter looks like:</p>
<div class="highlight"><pre><span></span>...
<span class="o">[</span>hooks<span class="o">]</span>
<span class="nv">update</span> <span class="o">=</span> ./manage.py collectstatic --noinput 
</pre></div>


<p>which I think is pretty self-explanatory! Now only one copy of the CSS is kept
in the central repository, but the deployed site is set up automatically when
I pull down the changes from that repo and update the working copy.</p></div>

  </article>
</section>

<script type="application/ld+json">
  {"articleSection": "development", "author": {"@type": "Person", "name": "Jonathan Sharpe"}, "datePublished": "2015-08-15T18:47:00+01:00", "headline": "Setting up static files in Django", "mainEntityOfPage": {"@type": "WebPage", "@id": "../../../2015/Aug/15/django-static-shock.html"}, "@context": "http://schema.org", "@type": "BlogPosting", "description": "Avoiding duplication of static files by using Mercurial hooks."}
</script>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
<div id="mc_embed_signup">
  <form
      action="https://jonrshar.us15.list-manage.com/subscribe/post?u=7ada11180797f3af73228bf0b&amp;id=d172abcbd2"
      method="post" id="mc-embedded-subscribe-form"
      name="mc-embedded-subscribe-form" class="validate" target="_blank"
      novalidate>

    <h2 class="menu-label">Mailing List</h2>

    <div id="mc_embed_signup_scroll">
      <div class="field mc-field-group">
        <label for="mce-EMAIL" class="label is-small">Email</label>
        <div class="field-body">
          <div class="field">
            <p class="control has-icons-left">
              <input type="email" name="EMAIL" class="input required email is-small"
                     id="mce-EMAIL" placeholder="Email address">
              <span class="icon is-small is-left">
              <i class="fa fa-envelope"></i>
            </span>
            </p>
          </div>
        </div>
      </div>
      <div class="field">
        <label for="mce-FNAME" class="label is-small">Name</label>
        <div class="field-body">
          <div class="field is-grouped">
            <p class="control is-expanded">
              <input class="input is-small" type="text" value="" name="FNAME"
                     id="mce-FNAME" placeholder="First">
            </p>
            <p class="control is-expanded">
              <input class="input is-small" type="text" value="" name="LNAME"
                     id="mce-LNAME" placeholder="Last">
            </p>
          </div>
        </div>
      </div>
      <div class="field is-grouped">
        <p class="control">
          <input type="submit" name="subscribe" value="Subscribe"
                 class="button is-small is-success" id="mc-embedded-subscribe">
        </p>
          <p class="control">
            <span class="help">
              Powered by
              <a href="http://eepurl.com/cNv6Rb"
                 title="MailChimp - email marketing made easy and fun">
                MailChimp
              </a>
            </span>
          </p>
      </div>

      <div id="mce-responses" class="clear">
        <div class="response help is-danger" id="mce-error-response"
             style="display:none"></div>
        <div class="response help is-success" id="mce-success-response"
             style="display:none"></div>
      </div>

      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_7ada11180797f3af73228bf0b_d172abcbd2"
               tabindex="-1" value="">
      </div>
    </div>
  </form>
</div>

          <p class="menu-label">Other Pages</p>
          <ul class="menu-list">
                <li><a                        href="../../../pages/about.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">About</span>
                </a></li>
          </ul>
          <p class="menu-label">Links</p>
          <ul class="menu-list">
              <li><a href="http://engineering.pivotal.io/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Pivotal Engineering Journal</span>
              </a></li>
              <li><a href="http://blog.cleancoder.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">The Clean Code Blog</span>
              </a></li>
              <li><a href="https://codeascraft.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Code as Craft</span>
              </a></li>
              <li><a href="http://corgibytes.com/blog/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Corgibytes Blog</span>
              </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="https://github.com/textbook">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text">GitHub</span>
    </a></li>
    <li><a href="http://stackoverflow.com/users/3001761/jonrsharpe">
      <span class="icon is-small">
          <i class="fa fa-stack-overflow fa-fw"></i>
      </span>
      <span class="link-text">Stack Overflow</span>
    </a></li>
    <li><a href="https://twitter.com/jonrsharpe">
      <span class="icon is-small">
          <i class="fa fa-twitter fa-fw"></i>
      </span>
      <span class="link-text">Twitter</span>
    </a></li>
    <li><a href="https://500px.com/jonrsharpe">
      <span class="icon is-small">
          <i class="fa fa-500px fa-fw"></i>
      </span>
      <span class="link-text">500px</span>
    </a></li>


</ul>          <p class="menu-label">License</p>
          
<ul class="menu-list">
  <li>
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
      <span class="icon is-small">
        <i class="fa fa-creative-commons fa-fw"></i>
      </span>
      <span>CC BY-SA 4.0</span>
    </a>
  </li>
</ul>

      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
 <p class="subtitle">These are my opinions - if you don't like them, I have others</p>    <div class="credits">
      <span><a href="https://github.com/textbook/bulrush">Bulrush</a> theme for
        <a href="https://blog.getpelican.com/">Pelican</a></span>
      <span><span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5</span>
      <span><span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3</span>
      <span>Made with <a href="https://bulma.io">Bulma</a></span>
    </div>
  </div>
  <div class="github-fork-ribbon-wrapper is-hidden-mobile is-hidden-print">
    <div class="github-fork-ribbon">
      <a href="https://github.com/textbook/textbook.github.io-source">
        <i class="fa fa-github fa-fw"></i>
        Fork me on GitHub
      </a>
    </div>
  </div>
</footer>

<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'navbar-menu') {
      nav.className = 'navbar-menu is-active';
    } else {
      nav.className = 'navbar-menu';
    }
  });
</script>
</body>
</html>