<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>ngTemplateOutlet tricks</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <link rel="stylesheet" href="../../../theme/css/main.557acf99.css">
  <style media="print">.is-hidden-print{display:none !important}</style>
      <link rel="stylesheet" href="../../../custom.css">
<meta property="og:title" content="textbook - ngTemplateOutlet tricks">
  <meta property="og:description" content="Using an Angular ngTemplateOutlet to bind child content from the parent template.">
<meta property="og:url" content="../../../2017/May/29/angular-ng-template-outlet.html">
    <meta property="og:image" content="../../../images/avatar.png">
    <meta name="twitter:image:alt" content="textbook | These are my opinions - if you don't like them, I have others">
<meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@jonrsharpe">
  <meta name="twitter:site" content="@jonrsharpe">
<meta property="og:site_name" content="textbook">
<meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-05-29T15:30:00+01:00">
    <meta property="article:tag" content="angular">
    <meta property="article:tag" content="html">
  <meta property="article:section" content="development">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="navbar">
        <div class="navbar-brand">
          <a class="navbar-item title is-3"
             href="../../../">textbook</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="navbar has-shadow is-hidden-print">
  <div class="container">
    <div class="navbar-center"></div>
    <span id="navToggle" class="navbar-burger">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-end">
              <a class="navbar-item is-tab "
                 href="../../../category/work.html">work</a>
              <a class="navbar-item is-tab "
                 href="../../../category/meta.html">meta</a>
              <a class="navbar-item is-tab is-active"
                 href="../../../category/development.html">development</a>
        </div>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
<section id="content" class="body">
  <article>
    <h1 class="title">
      <a href="../../../2017/May/29/angular-ng-template-outlet.html" rel="bookmark"
         title="Permalink to ngTemplateOutlet tricks">ngTemplateOutlet tricks</a></h1>
<footer class="post-info">
  <abbr class="published" title="2017-05-29T15:30:00+01:00">
    Published <span class="is-info">Mon 29 May 2017</span>
    in <a href="../../../category/development.html">development</a>
  </abbr>

    <p class="author">
      <em>by           Jonathan Sharpe
</em>
      <span class="tag is-small is-rounded">
        <a href="../../../tag/angular.html">angular</a>
      </span>
      <span class="tag is-small is-rounded">
        <a href="../../../tag/html.html">html</a>
      </span>
    </p>
  
</footer>    <div class="section"><p>I mentioned in <a href="../../../2017/May/20/angular-ng-elements.html">a previous article</a> that the limitations of projecting
content from a parent element to its child element, for example:</p>
<div class="highlight"><pre><span></span><span class="c">&lt;!-- template --&gt;</span>
<span class="p">&lt;</span><span class="nt">ng-content</span><span class="p">&gt;&lt;/</span><span class="nt">ng-content</span><span class="p">&gt;</span>

<span class="c">&lt;!-- usage --&gt;</span>
<span class="p">&lt;</span><span class="nt">my-component</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>I am a paragraph.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">my-component</span><span class="p">&gt;</span>

<span class="c">&lt;!-- result --&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>I am a paragraph.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div>


<p>were that you can't repeat the projection multiple times or access properties
on the child class from the parent template. However, one of
<a href="https://stackoverflow.com/users/217408/g%C3%BCnter-z%C3%B6chbauer">Günter Zöchbauer</a>'s <em>many</em> contributions to the Angular community on Stack
Overflow is <a href="https://stackoverflow.com/a/37676946/3001761">this answer</a> outlining how the <a href="https://angular.io/docs/ts/latest/api/common/index/NgTemplateOutlet-directive.html"><code>ngTemplateOutlet</code></a> can be
used to do this. It's somewhat more complex than simply adding an <code>ng-content</code>
element, but allows for more complex behaviour too.</p>
<hr>
<p>To give a more specific case, imagine you're writing an autocomplete input,
where suggestions are fetched as the user types and shown beneath the text box.
A simple approach might define the child template like this:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;suggestions&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;suggestion&quot;</span> <span class="err">*</span><span class="na">ngFor</span><span class="o">=</span><span class="s">&quot;let suggestion of suggestions&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ suggestion.name }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ suggestion.email }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>


<p>This is limiting, though; the structure of each suggestion is fixed, making the
component less reusable. It would be more flexible if we could define the
suggestion template in the parent component then inject each <code>suggestion</code> into
it to provide the display values.</p>
<p>Accessing an <code>ng-template</code> defined in the parent template as follows:</p>
<div class="highlight"><pre><span></span><span class="kd">@Component</span><span class="p">({</span>
  <span class="nx">selector</span><span class="o">:</span> <span class="s1">&#39;my-child&#39;</span><span class="p">,</span>
  <span class="p">...</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">ChildComponent</span> <span class="p">{</span> 
  <span class="kd">@ContentChild</span><span class="p">(</span><span class="nx">TemplateRef</span><span class="p">)</span> <span class="nx">parentTemplate</span><span class="p">;</span>

  <span class="nx">suggestions</span><span class="o">:</span> <span class="p">{</span> <span class="nx">name</span>: <span class="kt">string</span><span class="p">,</span> <span class="nx">email</span>: <span class="kt">string</span> <span class="p">}[]</span> <span class="o">=</span> <span class="p">[...];</span>
<span class="p">}</span>
</pre></div>


<p>and using an <code>ngTemplateOutlet</code> to render it out, with the child template
defined as:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;suggestions&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="err">*</span><span class="na">ngFor</span><span class="o">=</span><span class="s">&quot;let suggestion of suggestions&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">ng-container</span> <span class="err">*</span><span class="na">ngTemplateOutlet</span><span class="o">=</span><span class="s">&quot;parentTemplate; context: { $implicit: suggestion }&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">ng-container</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>


<p>allows you to provide the structure of each suggestion in the parent, but using
the <code>suggestion</code> variable defined in the <code>ngFor</code> loop in the child:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">my-child</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">ng-template</span> <span class="na">let-suggestion</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;suggestion&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ suggestion.name }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ suggestion.email }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">ng-template</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">my-child</span><span class="p">&gt;</span>
</pre></div>


<p>The key points here are:</p>
<ul>
<li>
<p>Using the <a href="https://angular.io/docs/ts/latest/api/core/index/ContentChild-decorator.html"><code>ContentChild</code></a> with <a href="https://angular.io/docs/ts/latest/api/core/index/TemplateRef-class.html"><code>TemplateRef</code></a> in the child to access
   the <code>ng-template</code> element defined in the parent;</p>
</li>
<li>
<p>Providing a <code>context</code> to inject into the template and binding the
   <code>suggestion</code> variable to the <code>$implicit</code> key to make that the default value
   of the context; and</p>
</li>
<li>
<p>Placing <code>let-suggestion</code> on the parent's <code>ng-template</code> element to bind that
   default value context to the name <code>suggestion</code> in the parent (you can also
   use <code>let-nameInParent="nameInContext"</code> to bind non-default context values;
   <code>let-nameInParent</code> without a value is effectively shorthand for
   <code>let-nameInParent="$implicit"</code>).</p>
</li>
</ul>
<p>Here is the above example as a Plunkr so you can play with it:</p>
<iframe src="https://embed.plnkr.co/QNUe6R/?show=child,preview" 
        frameborder=0 
        width="100%" 
        height="400px">
</iframe>

<hr>
<p>The downside of this is that the parent needs to have a specific layout; it has
to define an <code>ng-template</code> with the appropriate <code>let-</code> attribute to gain access
to the child property. If you read the previous article, you may be thinking
that an <code>ng-template</code> with an attribute on it looks exactly like the de-sugared
versions of structural directives. I thought the same thing, and wondered if I
could write a structural directive of my own that would be applied as follows:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">my-child</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;suggestion&quot;</span> <span class="err">*</span><span class="na">suggestion</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ suggestion.name }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ suggestion.email }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">my-child</span><span class="p">&gt;</span>
</pre></div>


<p>and would generate the appropriate template in a simplified way. Sadly, it
seems like you can't access the actual template element from the directive, as
it never gets rendered. A no-op directive as follows:</p>
<div class="highlight"><pre><span></span><span class="kd">@Directive</span><span class="p">({</span>
  <span class="nx">selector</span><span class="o">:</span> <span class="s1">&#39;[suggestion]&#39;</span><span class="p">,</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">SuggestionDirective</span> <span class="p">{</span> <span class="p">}</span>
</pre></div>


<p><em>can</em> be used to simplify the markup slightly:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">my-child</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;suggestion&quot;</span> <span class="err">*</span><span class="na">suggestion</span><span class="o">=</span><span class="s">&quot;let suggestion&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ suggestion.name }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ suggestion.email }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">my-child</span><span class="p">&gt;</span>
</pre></div>


<p>but you still need to explicitly include the <code>let</code>. I am yet to figure out how
to get around this (or if you even can).</p></div>

  </article>
</section>

<script type="application/ld+json">
  {"articleSection": "development", "author": {"@type": "Person", "name": "Jonathan Sharpe"}, "datePublished": "2017-05-29T15:30:00+01:00", "headline": "ngTemplateOutlet tricks", "mainEntityOfPage": {"@type": "WebPage", "@id": "../../../2017/May/29/angular-ng-template-outlet.html"}, "@context": "http://schema.org", "@type": "BlogPosting", "description": "Using an Angular ngTemplateOutlet to bind child content from the parent template."}
</script>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
<div id="mc_embed_signup">
  <form
      action="https://jonrshar.us15.list-manage.com/subscribe/post?u=7ada11180797f3af73228bf0b&amp;id=d172abcbd2"
      method="post" id="mc-embedded-subscribe-form"
      name="mc-embedded-subscribe-form" class="validate" target="_blank"
      novalidate>

    <h2 class="menu-label">Mailing List</h2>

    <div id="mc_embed_signup_scroll">
      <div class="field mc-field-group">
        <label for="mce-EMAIL" class="label is-small">Email</label>
        <div class="field-body">
          <div class="field">
            <p class="control has-icons-left">
              <input type="email" name="EMAIL" class="input required email is-small"
                     id="mce-EMAIL" placeholder="Email address">
              <span class="icon is-small is-left">
              <i class="fa fa-envelope"></i>
            </span>
            </p>
          </div>
        </div>
      </div>
      <div class="field">
        <label for="mce-FNAME" class="label is-small">Name</label>
        <div class="field-body">
          <div class="field is-grouped">
            <p class="control is-expanded">
              <input class="input is-small" type="text" value="" name="FNAME"
                     id="mce-FNAME" placeholder="First">
            </p>
            <p class="control is-expanded">
              <input class="input is-small" type="text" value="" name="LNAME"
                     id="mce-LNAME" placeholder="Last">
            </p>
          </div>
        </div>
      </div>
      <div class="field is-grouped">
        <p class="control">
          <input type="submit" name="subscribe" value="Subscribe"
                 class="button is-small is-success" id="mc-embedded-subscribe">
        </p>
          <p class="control">
            <span class="help">
              Powered by
              <a href="http://eepurl.com/cNv6Rb"
                 title="MailChimp - email marketing made easy and fun">
                MailChimp
              </a>
            </span>
          </p>
      </div>

      <div id="mce-responses" class="clear">
        <div class="response help is-danger" id="mce-error-response"
             style="display:none"></div>
        <div class="response help is-success" id="mce-success-response"
             style="display:none"></div>
      </div>

      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_7ada11180797f3af73228bf0b_d172abcbd2"
               tabindex="-1" value="">
      </div>
    </div>
  </form>
</div>

          <p class="menu-label">Other Pages</p>
          <ul class="menu-list">
                <li><a                        href="../../../pages/about.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">About</span>
                </a></li>
          </ul>
          <p class="menu-label">Links</p>
          <ul class="menu-list">
              <li><a href="http://engineering.pivotal.io/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Pivotal Engineering Journal</span>
              </a></li>
              <li><a href="http://blog.cleancoder.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">The Clean Code Blog</span>
              </a></li>
              <li><a href="https://codeascraft.com/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Code as Craft</span>
              </a></li>
              <li><a href="http://corgibytes.com/blog/">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text">Corgibytes Blog</span>
              </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="https://github.com/textbook">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text">GitHub</span>
    </a></li>
    <li><a href="http://stackoverflow.com/users/3001761/jonrsharpe">
      <span class="icon is-small">
          <i class="fa fa-stack-overflow fa-fw"></i>
      </span>
      <span class="link-text">Stack Overflow</span>
    </a></li>
    <li><a href="https://twitter.com/jonrsharpe">
      <span class="icon is-small">
          <i class="fa fa-twitter fa-fw"></i>
      </span>
      <span class="link-text">Twitter</span>
    </a></li>
    <li><a href="https://500px.com/jonrsharpe">
      <span class="icon is-small">
          <i class="fa fa-500px fa-fw"></i>
      </span>
      <span class="link-text">500px</span>
    </a></li>


</ul>          <p class="menu-label">License</p>
          
<ul class="menu-list">
  <li>
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
      <span class="icon is-small">
        <i class="fa fa-creative-commons fa-fw"></i>
      </span>
      <span>CC BY-SA 4.0</span>
    </a>
  </li>
</ul>

      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
 <p class="subtitle">These are my opinions - if you don't like them, I have others</p>    <div class="credits">
      <span><a href="https://github.com/textbook/bulrush">Bulrush</a> theme for
        <a href="https://blog.getpelican.com/">Pelican</a></span>
      <span><span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5</span>
      <span><span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3</span>
      <span>Made with <a href="https://bulma.io">Bulma</a></span>
    </div>
  </div>
  <div class="github-fork-ribbon-wrapper is-hidden-mobile is-hidden-print">
    <div class="github-fork-ribbon">
      <a href="https://github.com/textbook/textbook.github.io-source">
        <i class="fa fa-github fa-fw"></i>
        Fork me on GitHub
      </a>
    </div>
  </div>
</footer>

<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'navbar-menu') {
      nav.className = 'navbar-menu is-active';
    } else {
      nav.className = 'navbar-menu';
    }
  });
</script>
</body>
</html>